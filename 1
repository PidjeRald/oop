#include <iostream>
using namespace::std;
using TElem = int;
struct Tree;
using TElem2 = Tree*;

struct Stack {
	TElem2 data;
	Stack* next;
};

void initStack(Stack* top, TElem2 x) {
	top->data = x;
	top->next = NULL;
}

TElem2 popStack(Stack*& top) {
	Stack* t = top;
	top = top->next;
	t->next = NULL;
	TElem2 x = t->data;
	delete t;
	return x;
}

void pushStack(Stack*& top, TElem2 x) {
	Stack* t = new Stack;
	initStack(t, x);
	if (top) {
		t->next = top;
		top = t;
	}
	else
		top = t;
}

struct Tree {
	TElem key;
	Tree* left, * right;
};

Tree* first(TElem x) {
	Tree* root = new Tree;
	root->key = x;
	root->left = NULL;
	root->right = NULL;
	return root;
}

bool add(Tree* root, TElem x) {
	Tree* t = root, * prev = root;
	while (t) {
		prev = t;
		if (t->key == x)
			return 0;
		else
			if (t->key < x)
				t = t->right;
			else
				t = t->left;
	}
	Tree* node = first(x);
	if (x < prev->key)
		prev->left = node;
	else
		prev->right = node;
	return 1;
}

TElem leftLeaf(Tree* root) {
	while (root->left) {
		root = root->left;
	}
	return root->key;
}

Tree* search(Tree* root, TElem x) {
	Tree* t = root;
	while (t) {
		if (t->key == x)
			return t;
		else
			if (x < t->key)
				t = t->left;
			else
				t = t->right;
	}
	return NULL;
}

unsigned int height(Tree* root) {
	if (root == 0)
		return 0;
	int left, right;
	if (root->left != NULL) {
		left = height(root->left);
	}
	else
		left = -1;
	if (root->right != NULL) {
		right = height(root->right);
	}
	else
		right = -1;
	int max;
	if (left > right)
		max = left;
	else
		max = right;
	return max + 1;
}

void print(Tree* root, int level = 0) {
	if (root->right)
		print(root->right, level + 1);
	for (int i = 0; i < level; i++)
		cout << " ";
	cout << root->key << endl;
	if (root->left)
		print(root->left, level + 1);
}

/*bool compare(Tree* root1, Tree* root2) {
	if (root1->key != root2->key || root1->left == NULL && root2->left != NULL || root1->left != NULL && root2->left == NULL || root1->right == NULL && root2->right != NULL || root1->right != NULL && root2->right == NULL)
		return false;
	if (root1->left == NULL && root1->right == NULL && root2->left == NULL && root2->right == NULL)
		return true;
	if (root1->left == NULL && root2->left == NULL && root1->right != NULL && root2->right != NULL)
		return compare(root1->right, root2->right);
	if (root1->left != NULL && root2->left != NULL && root1->right == NULL && root2->right == NULL)
		return compare(root1->left, root2->left);
	return (compare(root1->left, root2->left) && compare(root1->right, root2->right));
}*/

bool compare(Tree* root1, Tree* root2) {
	Stack* s1 = NULL, * s2 = NULL;
	while (root1 && root2) {
		cout << root1->key << endl;
		if (root1->key != root2->key)
			return 0;
		if (root1->right && root2->right) {
			pushStack(s1, root1->right);
			pushStack(s2, root2->right);
		}
		else
			if (root1->right || root2->right)
				return 0;
		if (root1->left && root2->left) {
			root1 = root1->left;
			root2 = root2->left;
		}
		else
			if (root1->left || root2->left)
				return 0;
			else
				if (s1 && s2) {
					root1 = popStack(s1);
					root2 = popStack(s2);
				}
				else
					return 1;
	}
	if (root1 || root2)
		return 0;
	return 1;
}

int main() {
	setlocale(LC_ALL, "RU");
	int arr1[] = { 5,3,7,1,4,6,9 };
	int arr2[] = { 5,3,7,1,4,6,9 };
	int N1 = size(arr1);
	int N2 = size(arr2);
	Tree* root1 = first(arr1[0]);
	Tree* root2 = first(arr2[0]);
	for (int i = 1; i < N1; i++) {
		add(root1, arr1[i]);
	}
	for (int i = 1; i < N2; i++) {
		add(root2, arr2[i]);
	}
	print(root1);
	cout << "compare(root1,root2): " << compare(root1, root2) << endl;
	return 0;
}
